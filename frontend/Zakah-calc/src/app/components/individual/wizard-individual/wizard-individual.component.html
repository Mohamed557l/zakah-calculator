<div class="flex flex-col items-center justify-start p-4 pt-10 sm:pt-16">
  <div class="w-full max-w-2xl">
    
    <!-- Steps Header -->
    <div class="mb-8">
      <div class="flex items-center">
        @for (step of steps(); let i = $index; track $index) {
          <div class="flex items-center text-emerald-600 relative">
            <div
              class="rounded-full transition duration-500 ease-in-out h-10 w-10 flex items-center justify-center border-2"
              [class.bg-emerald-600]="i <= currentStep()"
              [class.text-white]="i <= currentStep()"
              [class.border-emerald-600]="i <= currentStep()"
              [class.border-slate-300]="i > currentStep()"
              [class.text-slate-500]="i > currentStep()">
              @if (i < currentStep()) {
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
              } @else {
                <span>{{ i + 1 }}</span>
              }
            </div>
            <div class="absolute top-0 -ms-10 text-center mt-14 w-32 text-xs font-medium uppercase"
              [class.text-emerald-600]="i <= currentStep()"
              [class.text-slate-400]="i > currentStep()">
              {{ step }}
            </div>
          </div>
          @if (!$last) {
            <div class="flex-auto border-t-2 transition duration-500 ease-in-out"
              [class.border-emerald-600]="i < currentStep()"
              [class.border-slate-300]="i >= currentStep()">
            </div>
          }
        }
      </div>
    </div>

    <!-- Step Content -->
    <div class="bg-white rounded-xl shadow-lg p-6 sm:p-8 animate-slide-in-right space-y-4">
      
      <!-- Step 0 -->
      @if (currentStep() === 0) {
        <h2 class="text-2xl font-bold text-slate-800 mb-2">حساب زكاة الفرد</h2>
        <p class="text-slate-500 mb-6">أدخل بيانات ميزانيتك لمعرفة مقدار الزكاة المستحقة</p>
        <button class="px-6 py-2 bg-emerald-600 text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors" (click)="next()">ابدأ</button>
      }

      <!-- Step 1 -->
      @if (currentStep() === 1) {
        <label class="block text-sm text-slate-600 mb-2">تاريخ الميزانية</label>
        <input type="date" class="w-full p-3 bg-white border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"
          name="calculationDate"
          [value]="formData().calculationDate"
          (change)="onInputChange($event)" />
      }

      <!-- Step 2 -->
      @if (currentStep() === 2) {
        <h3 class="text-xl font-bold text-slate-800 mb-2">أصول الفرد</h3>
        <div class="space-y-4">
          <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="bonds" type="number" placeholder="السندات"
            [value]="formData().bonds" (input)="onInputChange($event)" />
          <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="stocks" type="number" placeholder="الأسهم"
            [value]="formData().stocks" (input)="onInputChange($event)" />
          <!-- <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="inventory" type="number" placeholder="المخزون"
            [value]="formData().go" (input)="onInputChange($event)" /> -->
          <!-- <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="accountsReceivable" type="number" placeholder="المديونيات"
            [value]="formData()." (input)="onInputChange($event)" /> -->
        </div>
      }

      <!-- Step 3 -->
      @if (currentStep() === 3) {
        <h3 class="text-xl font-bold text-slate-800 mb-2">الخصوم</h3>
        <div class="space-y-4">
          <!-- <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="accountsPayable" type="number" placeholder="الدائنون"
            [value]="formData()" (input)="onInputChange($event)" />
          <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="accruedExpenses" type="number" placeholder="المصروفات المستحقة"
            [value]="formData().accruedExpenses" (input)="onInputChange($event)" />
          <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="shortTermLiability" type="number" placeholder="قروض قصيرة الأجل"
            [value]="formData().shortTermLiability" (input)="onInputChange($event)" />
          <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="yearlyLongTermLiabilities" type="number" placeholder="التزامات طويلة الأجل"
            [value]="formData().yearlyLongTermLiabilities" (input)="onInputChange($event)" /> -->
        </div>
      }

      <!-- Step 4 -->
      @if (currentStep() === 4) {
        <h3 class="text-xl font-bold text-slate-800 mb-2">سعر الذهب</h3>
        <input class="w-full p-3 bg-white border border-slate-300 rounded-lg" name="goldPrice" type="number" placeholder="سعر جرام الذهب"
          [value]="formData().goldPrice" (input)="onInputChange($event)" />
      }

      <!-- Step 5 -->
      @if (currentStep() === 5) {
        <h3 class="text-xl font-bold text-slate-800 mb-2">مراجعة البيانات</h3>
        <div class="rounded-lg border border-slate-200 p-4 space-y-2">
          <div class="flex justify-between"><span>إجمالي النقدية</span><span>{{ formData().bonds| currency:'EGP' }}</span></div>
          <div class="flex justify-between"><span>الاستثمارات</span><span>{{ formData().stocks | currency:'EGP' }}</span></div>
          <!-- <div class="flex justify-between"><span>المخزون</span><span>{{ formData().stocks | currency:'EGP' }}</span></div> -->
          <div class="flex justify-between"><span>المديونيات</span><span>{{ formData().stocks | currency:'EGP' }}</span></div>
        </div>
        <button   
          [disabled]="isCalculating()"
          (click)="calculate()"
          class="px-6 py-2 bg-emerald-600 text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors mt-4 w-full flex justify-center disabled:opacity-75 disabled:cursor-not-allowed">
          {{ isCalculating() ? 'جاري الحساب...' : 'احسب الزكاة' }}
        </button>
      }

    </div>

    <!-- Navigation -->
    <div class="flex justify-between mt-8">
      <button class="px-6 py-2 bg-slate-200 text-slate-700 font-semibold rounded-lg hover:bg-slate-300 transition-colors"
        [disabled]="currentStep() === 0" (click)="back()">رجوع</button>
      @if (currentStep() < steps().length - 1) {
        <button class="px-6 py-2 bg-emerald-600 text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors"
          (click)="next()">التالي</button>
      }
    </div>

  </div>
</div>
